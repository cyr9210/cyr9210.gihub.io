<!DOCTYPE html>
<html>
  <head><meta name="generator" content="Hexo 3.8.0">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta name="description" content="개발공부 정리 블로그">
  <meta name="keyword" content="Java, Spring, SQL, JavaScript">
  
    <link rel="shortcut icon" href="/css/images/logo.png">
  
  <title>
    
      개발환경 세팅, Junit 테스트, OracleDB 연동, mybaits연동, log4jdbc, MVC Controller, 파일업/다운로드 (KOSTA) | Bong&#39;s blog
    
  </title>
  <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.css" rel="stylesheet">
  <link href="//cdn.bootcss.com/highlight.js/9.12.0/styles/tomorrow.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
  
  <script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
  <script src="//cdn.bootcss.com/geopattern/1.2.3/js/geopattern.min.js"></script>
  <script src="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>

</head>
<div class="wechat-share">
  <img src="/css/images/logo.png">
</div>

  <body>
    <header class="header fixed-header">
  <div class="header-container">
    <a class="home-link" href="/">
      <div class="logo"></div>
      <span>Bong's blog</span>
    </a>
    <ul class="right-list">
      
        <li class="list-item">
          
            <a href="/" class="item-link">Home</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/tags/" class="item-link">Tags</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/about/" class="item-link">About</a>
          
        </li>
      
    </ul>
    <div class="menu">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </div>
    <div class="menu-mask">
      <ul class="menu-list">
        
          <li class="menu-item">
            
              <a href="/" class="menu-link">Home</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/tags/" class="menu-link">Tags</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/about/" class="menu-link">About</a>
            
          </li>
        
      </ul>
    </div>
  </div>
</header>

    <div id="article-banner">
  <h2>개발환경 세팅, Junit 테스트, OracleDB 연동, mybaits연동, log4jdbc, MVC Controller, 파일업/다운로드 (KOSTA)</h2>
  <p class="post-date">2019-01-29</p>
  <div class="arrow-down">
    <a href="javascript:;"></a>
  </div>
</div>
<main class="app-body flex-box">
  <!-- Article START -->
  <article class="post-article">
    <section class="markdown-content"><p><img src="/images/springframwork-logo.png" alt="springf"></p>
<h1 id="KOSTA-DAY58"><a href="#KOSTA-DAY58" class="headerlink" title="KOSTA DAY58"></a>KOSTA DAY58</h1><h2 id="Springframework"><a href="#Springframework" class="headerlink" title="Springframework"></a>Springframework</h2><h3 id="개발환경-설정-Spring-MVC"><a href="#개발환경-설정-Spring-MVC" class="headerlink" title="개발환경 설정(Spring MVC)"></a>개발환경 설정(Spring MVC)</h3><p>해당 포스팅은 Eclipse를 통해 이루어진다. 추후에 IntelliJ 로 변경할 예정이다.</p>
<h4 id="프로젝트생성"><a href="#프로젝트생성" class="headerlink" title="프로젝트생성"></a>프로젝트생성</h4><p><img src="/images/springk/springk04-02.png" alt="springk"></p>
<p><img src="/images/springk/springk04-04.png" alt="springk"></p>
<p><img src="/images/springk/springk04-06.png" alt="springk"></p>
<ul>
<li>Spring Legacy Project를 생성한다.</li>
<li>Spirng MVC Project 선택</li>
<li>사용 될 Controller 피키지명 입력( 자동생성)</li>
</ul>
<p><img src="/images/springk/springk04-08.png" alt="springk"></p>
<p><img src="/images/springk/springk04-10.png" alt="springk"></p>
<ul>
<li>pom.xml에 Java 및 Spring, Maven의 버전을 변경한다.</li>
</ul>
<p><img src="/images/springk/springk04-12.png" alt="springk"></p>
<p><img src="/images/springk/springk04-13.png" alt="springk"></p>
<ul>
<li>maven update</li>
</ul>
<h4 id="Lombok-설치-및-라이브러리-추가"><a href="#Lombok-설치-및-라이브러리-추가" class="headerlink" title="Lombok 설치 및 라이브러리 추가"></a>Lombok 설치 및 라이브러리 추가</h4><blockquote>
<p><strong>Lombok이란?</strong><br>Java에서 자주 사용하는 생성자, setter/getter, toString()을 자동으로 생성해 주는 라이브러리이다.</p>
</blockquote>
<ul>
<li><a href="https://projectlombok.org/download" target="_blank" rel="noopener">Lombok홈페이지에서</a> 다운로드 한다.</li>
</ul>
<p><img src="/images/springk/springk04-14.png" alt="springk"></p>
<ul>
<li>Lombok을 설치한다.<br><br><br></li>
</ul>
<h3 id="JUnit-테스트"><a href="#JUnit-테스트" class="headerlink" title="JUnit 테스트"></a>JUnit 테스트</h3><blockquote>
<p><strong>xUnit이란?</strong><br>자바만 단위 테스팅 프레임 워크인 JUnit만 있는게 아니다. 다른 언어도 단위 테스트를 위한 프레임워크가 존재하며 보통 이름을 xUnit이라 칭한다.<br>ex) JUnit → java, CUnit → C ,CppUnit →c++</p>
</blockquote>
<h4 id="JUnit-assert-관련-메소드"><a href="#JUnit-assert-관련-메소드" class="headerlink" title="JUnit assert 관련 메소드"></a>JUnit assert 관련 메소드</h4><p><img src="/images/springk/springk04-15.png" alt="springk"><br>JUnit을 활용하여 설정이 잘 되었는지 확인해보자.</p>
<ul>
<li>pom.xml에 라이브러리 추가(junit 4.12버전)</li>
</ul>
<p><img src="/images/springk/springk04-16.png" alt="springk"></p>
<ul>
<li>root-context.xml 파일은 Spring과 관련된 설정을 작성하는 곳</li>
<li>‘어노테이션을 통해 sample 패키지를 스캔하여 객체를 만들겠다.’를 의미한다.</li>
</ul>
<p><img src="/images/springk/springk04-17.png" alt="springk"></p>
<p><img src="/images/springk/springk04-18.png" alt="springk"></p>
<ul>
<li>테스트 객체 추가</li>
<li>@Component 를 사용하여 Bean객체로 등록한다.</li>
<li>@Data를 통해 Lombok을 사용 (@Setter 의존성 주입)</li>
</ul>
<p><img src="/images/springk/springk04-19.png" alt="springk"></p>
<ul>
<li>src/test/java에 테스트파일 생성</li>
<li>@RunWith : JUnit 프레임워크의 테스트 실행 방법을 확장할 때 사용하는 어노테이션이다. SpringJUnit4ClassRunner라는 JUnit용 테스트 컨텍스트 프레임워크 확장 클래스를 지정해주면 JUnit이 테스트를 진행하는 중에 테스트가 사용할 애플리케이션 컨텍스트를 만들고 관리하는 작업을 진행해준다.<br>→JUnit에 내장된 Runner대신 그 클래스를 실행</li>
<li>@ContextConfiguration : 자동으로 만들어줄 애플리케이션 컨텍스트의 설정파일위치를 지정</li>
</ul>
<p><img src="/images/springk/springk04-20.png" alt="springk"></p>
<p><img src="/images/springk/springk04-21.png" alt="springk"></p>
<p><br><br></p>
<h3 id="Oracle-DB-연동"><a href="#Oracle-DB-연동" class="headerlink" title="Oracle DB 연동"></a>Oracle DB 연동</h3><ul>
<li>Build Path를 통해 Ojdbc 라이브러리를 추가한다.<br>(Maven으로 추가 시, 에러발생함으로 로컬환경에서 추가하도록 하자.)</li>
<li>pom.xml에 spring-jdbc 라이브러리 추가</li>
</ul>
<p><img src="/images/springk/springk04-22.png" alt="springk"></p>
<ul>
<li>src/test/java에 테스트 파일을 생성한다.</li>
<li>junit test 실행 결과 정상으로 나타난다.<br><br><br></li>
</ul>
<h3 id="mybatis연동"><a href="#mybatis연동" class="headerlink" title="mybatis연동"></a>mybatis연동</h3><p>spring에서는 mybatis를 쉽게 연동하기위해 라이브러리를 지원한다.</p>
<ul>
<li><p>pom.xml에 해당 라이브러리들을 추가한다.<br>HikariCP/spring-tx / mybatis / mybatis-spring<br><img src="/images/springk/springk04-23.png" alt="springk"></p>
</li>
<li><p>root-context.xml 설정</p>
</li>
<li>hikariCP라이브러리를 사용하여 상기와 같이 Connection Pool을 한다.<br>(상기예제의 diriverClassName, jdbcUrl 은 추후 log4jdbc설정을 위해 변경된 값이다. 주석처리한 부분이 원래 값)</li>
<li>dataSource 객체 생성 (ref = hikariConfig)</li>
<li>sqlSessionFactory 객체 생성(ref = dataSource)</li>
<li>mybatis-sping:scan을 사용하여 mapper패키지의 xml파일 및 인터페이스 파일을 검색하고 사용한다.</li>
</ul>
<p>먼저 DB와 연동되는지 확인해보자.</p>
<p><img src="/images/springk/springk04-24.png" alt="springk"></p>
<ul>
<li>@Setter 를 사용하여 DataSource 객체 및 SqlsessionFactory객체 생성</li>
<li>DB를 연결하고 잘 연결되었는지 확인하기 위해 session과 con 을 출력한다.</li>
</ul>
<blockquote>
<p>try 사용 시, 괄호안의 코드를 작성하면 try가 끝날때 내용을 자동으로 close 해준다.</p>
</blockquote>
<p>DB와 연동이 잘된다면 mybatis설정이 잘되었는지 확인해보자.</p>
<p><img src="/images/springk/springk04-25.png" alt="springk"></p>
<p><img src="/images/springk/springk04-26.png" alt="springk"></p>
<ul>
<li>mybatis로 연동될 인터페이스 생성</li>
<li>src/main/resources 에 인터페이스의 경로와 같도록 폴더를 생성하고 그안에 xml파일을 생성한다.</li>
<li>이전에 root-cotntex.xml에서 mybatis-spring : scan 경로와 같도록 해야한다.(자동으로 scan하기 위해서)</li>
</ul>
<p><img src="/images/springk/springk04-27.png" alt="springk"></p>
<ul>
<li>테스트 파일 작성 및 실행<br><br><br></li>
</ul>
<h3 id="log4jdbc-log4j2-설정"><a href="#log4jdbc-log4j2-설정" class="headerlink" title="log4jdbc-log4j2 설정"></a>log4jdbc-log4j2 설정</h3><p>sql 관련 log를 보다 가시성이 높게 표현되도록 변경해주는 라이브러리이다.</p>
<ul>
<li>pom.xml에 해당라이브러리를 추가한다.</li>
</ul>
<p><img src="/images/springk/springk04-28.png" alt="springk"></p>
<ul>
<li>src/main/resources에 log4jdbc2.properties를 추가한다.</li>
</ul>
<p><img src="/images/springk/springk04-29.png" alt="springk"></p>
<ul>
<li>root-context.xml 의 Connection Pool 세팅의 value값을 변경한다.<br>(HikariCP 라이브러리 사용)</li>
</ul>
<p>다시 테스트파일을 실행해보면 다음과 같은 결과가 나온다.</p>
<p><img src="/images/springk/springk04-30.png" alt="springk"><br><br></p>
<h3 id="MVC-Controller"><a href="#MVC-Controller" class="headerlink" title="MVC Controller"></a>MVC Controller</h3><p>Spring-MVC 패턴에서의 Controller의 역할을 알아보자.</p>
<ul>
<li>HttpServletRequest, HttpServletResponse를 거의 사용할 필요 없이 구현 가능</li>
<li>다양한 타입의 파라미터 처리, 리턴 타입이 가능</li>
<li>GET, POST 방식에 대한 어노테이션 처리 가능</li>
<li>상속/인터페이스 방식 대신 어노테이션 만으로도 설정 가능</li>
</ul>
<p>컨트롤러를 사용하여 톰캣서버를 실행해보자.</p>
<ul>
<li>pom.xml의 버전변경 (Spring legacy 로 생성된 lib들의 버전이 낮음)<br>spring → 5.0.7 / javax.servlet-api → 3.1.0 /<br>maven-compiler-plugin → 2.5.1</li>
</ul>
<p><img src="/images/springk/springk04-31.png" alt="springk"></p>
<ul>
<li>웹프로젝트 가능한 절대경로를 이용하는 구조를 사용하는것이 바람직함으로, Tomcat의 Module메뉴를 이용하여 ‘/’ 경로로 프로젝트가 실행될 수 있도록 처리한다.</li>
</ul>
<p><img src="/images/springk/springk04-32.png" alt="springk"></p>
<p><img src="/images/springk/springk04-33.png" alt="springk"></p>
<p><img src="/images/springk/springk04-34.png" alt="springk"></p>
<p><img src="/images/springk/springk04-35.png" alt="springk"></p>
<ul>
<li>servlet-context.xml 에 해당 패키지안을 찾아내도록 설정한다.</li>
<li>@Controller 를 사용하여 컨트롤러를 찾아낼 수 있도록한다.</li>
<li>RequestMapping(“/sample/*”) 주소 /sample/로 들어올시, 해당 컨드롤러에 매핑된다.</li>
<li>RequestMapping 과 GetMapping 을 사용하여 각각 mapping 하였다.<br>GetMapping get방식만 data를 받을 수 있다.<br>RequestMapping 은 get/post를 모두 지원하며 두방식 모두 지원시 배열로 처리할 수 있다.</li>
<li>void 함수로 return 값이 없으면 매핑 주소값을 return 한다.</li>
</ul>
<h4 id="파라미터-수집"><a href="#파라미터-수집" class="headerlink" title="파라미터 수집"></a>파라미터 수집</h4><p>spring에서는 파라미터가 자동으로 수집되는 기능을 지원한다.<br>즉, request.getParameter()를 이용하는 불편함이 없다. 예제를 통해 살펴보자.</p>
<p><img src="/images/springk/springk04-36.png" alt="springk"></p>
<p><img src="/images/springk/springk04-37.png" alt="springk"></p>
<p><img src="/images/springk/springk04-38.png" alt="springk"></p>
<ul>
<li>@Data 어노테테이션을 찾아 파라미터값으로 가진다.</li>
</ul>
<h4 id="파라미터-형변환"><a href="#파라미터-형변환" class="headerlink" title="파라미터 형변환"></a>파라미터 형변환</h4><p>파라미터수집을 다른용어로는 binding이라고 한다. 자동으로 변환이 가능한 data들은 변환을 하지만, 변환처리가 필요한 경우도 있다.<br>예를들어 문자를 Date 타입으로 변환하기 위해서는 다음과같은 과정이 필요하다.</p>
<p><img src="/images/springk/springk04-39.png" alt="springk"></p>
<p><img src="/images/springk/springk04-40.png" alt="springk"></p>
<p><img src="/images/springk/springk04-41.png" alt="springk"></p>
<ul>
<li>InitBinder를 사용하여 형변환을 할 수 있다.</li>
<li>DateTimeFormat 으로 대체 가능하다.(Chef 클래스 주석부분)</li>
</ul>
<h4 id="Json-변환"><a href="#Json-변환" class="headerlink" title="Json 변환"></a>Json 변환</h4><p>@ResponseBody를 사용하여 객체를 Json 타입으로 변환하여 출력이 가능하다.</p>
<ul>
<li>pom.xml에 jackson 라이브러리 추가</li>
</ul>
<p><img src="/images/springk/springk04-42.png" alt="springk"></p>
<p><img src="/images/springk/springk04-43.png" alt="springk"></p>
<ul>
<li>@ResponseBody 를 사용하여 Json객체로 출력하였다.</li>
</ul>
<h4 id="ResponseEntity-타입"><a href="#ResponseEntity-타입" class="headerlink" title="ResponseEntity 타입"></a>ResponseEntity 타입</h4><ul>
<li>원하는 헤더 정보 및 데이터를 전달 할 수 있다.</li>
<li>HttpHeaders 객체를 전달해 원하는 헤더 메세지로 가공이 가능하다.<br>예제를 통해 살펴보자.</li>
</ul>
<p><img src="/images/springk/springk04-44.png" alt="springk"></p>
<p><img src="/images/springk/springk04-45.png" alt="springk"><br>컨트롤러에서 리턴값을 ResponseEntity값으로 선언하였다.<br>(데이터 타입이다. 어노테이션이 아님)</p>
<ul>
<li>쌍따옴표를 사용하기 위해 \ 사용</li>
<li>결과값을 보면 알 수 있듯이,<br>HttpStatus.OK → status 200(정상)<br>header → 결과페이지의 헤더값 (Json타입) 라는 상태 코드를 전송한다.<br><br><br></li>
</ul>
<h3 id="파일업-다운로드"><a href="#파일업-다운로드" class="headerlink" title="파일업/다운로드"></a>파일업/다운로드</h3><h4 id="파일업로드"><a href="#파일업로드" class="headerlink" title="파일업로드"></a>파일업로드</h4><p>파일업로드 방법은 여러가지가 있는데 Servlet3.0이하버전에서 일반적으로 사용했던 가장 일반적인 commons-fileupload 방법에대해 알아보자.</p>
<ul>
<li>pom.xml에 commons-fileupload 라이브러리를 추가한다.</li>
</ul>
<p><img src="/images/springk/springk04-46.png" alt="springk"></p>
<p><img src="/images/springk/springk04-47.png" alt="springk"></p>
<p><img src="/images/springk/springk04-48.png" alt="springk"></p>
<p><img src="/images/springk/springk04-49.png" alt="springk"></p>
<ul>
<li>servlet-context.xml 아래와 같이 설정한다.<br>maxUploadSize : Request로 전달될 수 있는 최대의 크기<br>maxUploadSizePerFile : 하나의 파일 최대크기<br>maxlnMemorySize : 메모리상에서 유지하는 최대의 크기<br>uploadTempDir : 업로드 파일 경로(‘file:/’로 시작한 이유는 절대경로를 이용하려면 URI형태로 제공해야되기 때문에)</li>
<li>defaultEncoding는 한글처리를 해준다.</li>
<li>Controller를 통해서 views/sample/exUpload.jsp 로 간다.</li>
<li>exUpload.jsp에서 파일을 올릴수 있는 input태그 작성 (form태그의 속성들 주의)</li>
<li>form 이 post방식으로 컨트롤러로 오기때문에 @PostMapping 사용한다.</li>
<li>값이 여러개임으로 ArrayList사용 타입은 MultipartFile이며 변수명은 input태그의 name값으로 한다.</li>
<li>foreach(file-&gt;{});를 사용하여 log 출력<br><br><br></li>
</ul>
</section>
    <!-- Tags START -->
    
      <div class="tags">
        <span>Tags:</span>
        
  <a href="/tags#Springframework_kosta">
    <span class="tag-code">Springframework_kosta</span>
  </a>

      </div>
    
    <!-- Tags END -->
    <!-- NAV START -->
    
  <div class="nav-container">
    <!-- reverse left and right to put prev and next in a more logic postition -->
    
      <a class="nav-left" href="/2019/01/28/Spring/KostaSpring03/">
        <span class="nav-arrow">← </span>
        
          \@RequestParam, \@Pathvariable(RESTful), tiles, File up/down, JSON, AOP, Transaction (KOSTA)
        
      </a>
    
    
      <a class="nav-right" href="/2019/01/30/Spring/KostaSpring05/">
        
          Spring MVC TEST (KOSTA)
        
        <span class="nav-arrow"> →</span>
      </a>
    
  </div>

    <!-- NAV END -->
    <!-- 打赏 START -->
    
    <!-- 打赏 END -->
    <!-- 二维码 START -->
    
    <!-- 二维码 END -->
    
      <!-- No Comment -->
    
  </article>
  <!-- Article END -->
  <!-- Catalog START -->
  
    <aside class="catalog-container">
  <div class="toc-main">
    <strong class="toc-title">Catalog</strong>
    
      <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#KOSTA-DAY58"><span class="toc-nav-text">KOSTA DAY58</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Springframework"><span class="toc-nav-text">Springframework</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#개발환경-설정-Spring-MVC"><span class="toc-nav-text">개발환경 설정(Spring MVC)</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#프로젝트생성"><span class="toc-nav-text">프로젝트생성</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Lombok-설치-및-라이브러리-추가"><span class="toc-nav-text">Lombok 설치 및 라이브러리 추가</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#JUnit-테스트"><span class="toc-nav-text">JUnit 테스트</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#JUnit-assert-관련-메소드"><span class="toc-nav-text">JUnit assert 관련 메소드</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#Oracle-DB-연동"><span class="toc-nav-text">Oracle DB 연동</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#mybatis연동"><span class="toc-nav-text">mybatis연동</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#log4jdbc-log4j2-설정"><span class="toc-nav-text">log4jdbc-log4j2 설정</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#MVC-Controller"><span class="toc-nav-text">MVC Controller</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#파라미터-수집"><span class="toc-nav-text">파라미터 수집</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#파라미터-형변환"><span class="toc-nav-text">파라미터 형변환</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Json-변환"><span class="toc-nav-text">Json 변환</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#ResponseEntity-타입"><span class="toc-nav-text">ResponseEntity 타입</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#파일업-다운로드"><span class="toc-nav-text">파일업/다운로드</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#파일업로드"><span class="toc-nav-text">파일업로드</span></a></li></ol></li></ol></li></ol></li></ol>
    
  </div>
</aside>
  
  <!-- Catalog END -->
</main>

<script>
  (function () {
    var url = 'http://yoursite.com/2019/01/29/Spring/KostaSpring04/';
    var banner = ''
    if (banner !== '' && banner !== 'undefined' && banner !== 'null') {
      $('#article-banner').css({
        'background-image': 'url(' + banner + ')'
      })
    } else {
      $('#article-banner').geopattern(url)
    }
    $('.header').removeClass('fixed-header')

    // error image
    $(".markdown-content img").on('error', function() {
      $(this).attr('src', 'http://file.muyutech.com/error-img.png')
      $(this).css({
        'cursor': 'default'
      })
    })

    // zoom image
    $(".markdown-content img").on('click', function() {
      var src = $(this).attr('src')
      if (src !== 'http://file.muyutech.com/error-img.png') {
        var imageW = $(this).width()
        var imageH = $(this).height()

        var zoom = ($(window).width() * 0.95 / imageW).toFixed(2)
        zoom = zoom < 1 ? 1 : zoom
        zoom = zoom > 2 ? 2 : zoom
        var transY = (($(window).height() - imageH) / 2).toFixed(2)

        $('body').append('<div class="image-view-wrap"><div class="image-view-inner"><img src="'+ src +'" /></div></div>')
        $('.image-view-wrap').addClass('wrap-active')
        $('.image-view-wrap img').css({
          'width': `${imageW}`,
          'transform': `translate3d(0, ${transY}px, 0) scale3d(${zoom}, ${zoom}, 1)`
        })
        $('html').css('overflow', 'hidden')

        $('.image-view-wrap').on('click', function() {
          $(this).remove()
          $('html').attr('style', '')
        })
      }
    })
  })();
</script>







    <div class="scroll-top">
  <span class="arrow-icon"></span>
</div>
    <footer class="app-footer">
  <p class="copyright">
    &copy; 2019 | Proudly powered by <a href="https://hexo.io" target="_blank">Hexo</a>
    <br>
    Theme by <a href="https://github.com/yanm1ng">yanm1ng</a>
  </p>
</footer>

<script>
  function async(u, c) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }
</script>
<script>
  async("//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
    FastClick.attach(document.body);
  })
</script>

<script>
  var hasLine = 'true';
  async("//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js", function(){
    $('figure pre').each(function(i, block) {
      var figure = $(this).parents('figure');
      if (hasLine === 'false') {
        figure.find('.gutter').hide();
      }
      var lang = figure.attr('class').split(' ')[1] || 'code';
      var codeHtml = $(this).html();
      var codeTag = document.createElement('code');
      codeTag.className = lang;
      codeTag.innerHTML = codeHtml;
      $(this).attr('class', '').empty().html(codeTag);
      figure.attr('data-lang', lang.toUpperCase());
      hljs.highlightBlock(block);
    });
  })
</script>
<!-- Baidu Tongji -->

<script src="/js/script.js"></script>
  </body>
</html>